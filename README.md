# SO Start Grid - Управление стартовым городком

## Описание проекта

**SO Start Grid** - это Progressive Web App (PWA) для судей спортивного ориентирования, предназначенное для управления процессом запуска участников через стартовый городок.

### Проблема

Сейчас судья использует бумажную распечатку документа "Шахматка" (экспортируемого из программы SportOrg в HTML формате), на котором вручную отмечает статусы участников карандашом (зашел, опоздал, не пришел). Это неудобно, легко теряется информация, и сложно быстро получить статистику.

### Решение

Мобильное веб-приложение, которое:
- Импортирует HTML файл "Шахматка" из SportOrg
- Отображает расширенную таблицу с данными участников
- Позволяет быстро отмечать статусы участников
- Автоматически отслеживает текущее время и выделяет актуальную строку
- Генерирует отчеты о статусах участников

## Основной функционал

### Управление проектами
- Каждый импортированный HTML файл создает новый "проект"
- При первом открытии приложения (нет проектов) - показывается только кнопка "Создать проект" (импорт файла)
- При наличии проектов - отображается список существующих проектов и кнопка "Создать проект"
- Выбор проекта открывает его шахматку с таймером и контекстным меню
- Все проекты хранятся локально в браузере

### Импорт данных
- Загрузка HTML файла, экспортированного из SportOrg
- Парсинг данных о соревновании, участниках, группах и времени старта
- Создание нового проекта с автоматически сгенерированным именем (название соревнования + дата)

### Отображение шахматки
- Таблица с временами старта и номерами участников по коридорам
- Поддержка нескольких коридоров одновременно
- Дополнительная информация (ФИО участника, группа, статус оплаты) отображается только при долгом нажатии на номер участника

### Управление статусами участников
- **Быстрое нажатие** на номер участника → "Зашел" (зеленый цвет)
- **Долгое нажатие** на номер → меню с опциями:
  - "Опоздал" (оранжевый цвет)
  - "Не пришел" (красный цвет)
  - "Сбросить" (возврат в неотмеченное состояние)
- Статус можно изменить только через долгое нажатие

### Таймер старта
- Кнопка "Старт" изначально расположена в верхней части шахматки
- После нажатия "Старт" кнопка исчезает, чтобы не отвлекать внимание
- Выделение текущей строки (минута, которая идет сейчас)
- **Динамический интервал**: таймер автоматически вычисляет интервал между строками на основе времени старта участников
  - Например, если строка 1: 10:01:00, строка 2: 10:02:00 → интервал 1 минута
  - Если строка 2: 10:02:00, строка 3: 10:04:00 → интервал 2 минуты
  - Интервал может отличаться для разных пар строк в одном файле
- Автоматическое обновление текущей строки по вычисленному интервалу
- **Автоматический скроллинг**: при переходе на новую строку таймер автоматически прокручивает шахматку так, чтобы текущая строка была сверху экрана (предыдущие строки уходят вверх)
- Судья может вручную прокручивать шахматку в любое место, если это необходимо
- В контекстном меню доступен переключатель "Авто скроллинг текущей строки" для включения/выключения этой функции
- Контекстное меню (иконка в нижней правой части) с опциями:
  - **"Завершить"** - останавливает таймер
  - **"Отчет"** - открывает страницу отчета
  - **"Язык"** - выбор языка интерфейса (русский, английский, казахский)
  - **"Авто скроллинг текущей строки"** - переключатель для включения/выключения автоматического скроллинга
  - **"Сбросить таймер на N строку"** - с подтверждением:
    - Поле для ввода номера строки
    - Предупреждение: "Все статусы участников после этой строки будут сброшены, вы уверены?"
    - После подтверждения: таймер сбрасывается на указанную строку, все статусы участников после этой строки возвращаются в неотмеченное состояние
  - **"Удалить текущий проект"** - удаляет текущий проект с подтверждением, возвращает к списку проектов

### Отчеты
- Общая статистика: количество зашедших + опоздавших
- Детали по опоздавшим: номера, ФИО, время опоздания
- Детали по не пришедшим: номера, ФИО
- Экспорт в JSON/CSV
- Печать отчета

## Технологии

- **React** + **TypeScript** - основной фреймворк
- **PWA** - прогрессивное веб-приложение (установка на устройство)
- **LocalStorage** - локальное хранение данных
- **i18n** - поддержка русского, английского и казахского языков

## Структура данных SportOrg

Приложение работает с HTML файлами, экспортируемыми из SportOrg. Файл содержит JavaScript объект `race` со следующей структурой:

```javascript
race = {
  persons: [{ bib, start_time, group, ... }],
  groups: [{ name, start_corridor, ... }],
  organizations: [...],
  data: { start_datetime, title, ... }
}
```

- `start_time` - время старта в миллисекундах
- `start_corridor` - номер стартового коридора (0, 1, 2, ...)
- `bib` - номер участника

## Статусы участников

- **Зашел** (зеленый) - участник пришел вовремя
- **Опоздал** (оранжевый) - участник опоздал на старт
- **Не пришел** (красный) - участник не явился на старт
- **Не отмечен** (по умолчанию) - статус еще не определен

## Установка и запуск

### Требования

- Node.js 18+ 
- npm или yarn

### Установка зависимостей

```bash
npm install
```

### Запуск в режиме разработки

```bash
npm run dev
```

Приложение будет доступно по адресу `http://localhost:5173`

### Сборка для продакшена

```bash
npm run build
```

Собранные файлы будут в папке `dist/`

### Предварительный просмотр продакшен сборки

```bash
npm run preview
```

## Использование

1. **Создание проекта**: Нажмите "Создать проект" и выберите HTML файл, экспортированный из SportOrg
2. **Открытие проекта**: Выберите проект из списка для работы с ним
3. **Запуск таймера**: Нажмите кнопку "Старт" в верхней части экрана
4. **Отметка статусов**: 
   - Быстрое нажатие на номер участника → "Зашел"
   - Долгое нажатие → меню выбора статуса
5. **Просмотр отчета**: Откройте контекстное меню (три точки внизу справа) и выберите "Отчет"

## Лицензия

*Будет определена позже*

